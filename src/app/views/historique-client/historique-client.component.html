<div class="animated fadeIn">
  <div class="card">
    <h5 class="card-title">
      <div class="card-header"><b> Historique client </b></div>
    </h5>
    <div class="card-body">
      <form class="form-horizontal" [formGroup]="form">
        <div class="form-group row" style="margin-top: 10px;">
           <div class="col-xl-3 col-md-6">
             <label for="clientId">Client</label>
             <div style="text-align:center;margin-top: 10px;">
               <input class="form-control" list="Client" placeholder="{{'Client'}}" formControlName="clientId" id="clientId">
               <datalist id="Client">
                 <option *ngFor="let item of ClientList" [value]='item.raisonSociale'>{{ item.raisonSociale }}</option>
               </datalist>
             </div>
           </div>
           <div class="col-xl-3 col-md-6">
             <label for="dateDebut">Date début</label>
             <div style="text-align:center;">
               <input class="form-control" type="date" formControlName="dateDebut" id="dateDebut">
             </div>
           </div>
           <div class="col-xl-3 col-md-6">
             <label for="dateFin">Date Fin</label>
             <div style="text-align:center;">
               <input class="form-control" type="date" formControlName="dateFin" id="dateFin">
             </div>
           </div>
           <div class="col-xl-3 col-md-6">
             <label for="typeCompte">Type solde</label>
             <div style="text-align:center;">
               <select class="form-control" formControlName="typeCompte" id="typeCompte">
                 <option value="">Tous</option>
                 <option value="prépayé">Prépayé</option>
                 <option value="prépayé à terme">Prépayé à terme</option>
                 <option value="postpayé">Postpayé</option>
               </select>
             </div>
           </div>
           <div class="col-xl-3 col-md-6">
             <label for="NumCarte">Numéro carte</label>
             <div style="text-align:center;">
               <input class="form-control" type="text" formControlName="NumCarte" id="NumCarte" placeholder="Num Carte">
             </div>
           </div>
           <div class="col-xl-3 col-md-6">
             <label for="porteur">Porteur carte</label>
             <div style="text-align:center;">
               <input class="form-control" type="text" formControlName="porteur" id="porteur" placeholder="Nom Porteur">
             </div>
           </div>
        </div>
        <div class="col-md-12 text-right" style="margin-bottom: 10px;">
           <button class="btn btn-primary btn-ladda" data-style="expand-left" (click)="getLogTransactionRecharge()">
             <i class="fa fa-search"> Chercher </i>
           </button>
           <button style="margin-left: 10px;" (click)="getLogTransactionRechargeEXCEL()" class="btn btn-success"> Export excel</button>
        </div>
       </form>
       
      <div style="overflow-x:auto;">
        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="row-border hover display nowrap example"
        width="100%">          <thead>
            <tr>

              <th>Date</th>
              <th>ID client</th>
              <th>Client</th>
              <th>ID Porteur</th>
              <th>Porteur carte </th>
              <th>Numéro carte </th>
              <th>Type</th>
              <th>ID station</th>
              <th>Nom station</th>
              <th>N° ticket</th>
              <th><i class="fa fa-history" aria-hidden="true"></i> Transactions</th>
              <th><i class="fa fa-history" aria-hidden="true"></i> Recharge</th>

          </thead>
          <tbody>
            <tr *ngFor="let item of LogTransactionRecharge ">
              <td>{{item.dateTimeSystem | dateSql}}</td>
              <td>{{item.iDclient}}</td>
              <td>{{item.client}}</td>
              <td>{{item.idPorteur }}</td>
              <td>{{item.porteur }}</td>
              <td>{{item.numCarte }}</td>
              <td>{{item.typeCarte }}</td>
              <td> {{item.idStation }} </td>
              <td> {{item.nomStation }} </td>
              <td> {{item.numticket }} </td>

              <td align="center" class="form-horizontal"><span><i class="fa fa-eye"
                    [ngClass]="{'fa-eye': !showtransaction,'fa-eye-slash': showtransaction }"
                    (click)="selectClientTransaction(item, 'Transaction');  getLogDetailClientTransactions(item, 'Transaction')"
                    aria-hidden="true"></i></span>
              </td>
              <td align="center" class="form-horizontal"><span><i class="fa fa-eye"
                    [ngClass]="{'fa-eye': !showRecharge,'fa-eye-slash': showRecharge }"
                    (click)="selectClientRecharge(item, 'Recharge');  getLogDetailClientRecharge(item, 'Recharge')"
                    aria-hidden="true"></i></span>
              </td>

            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- ************************************* LOG Transaction ************************************************** -->

<div class="animated fadeIn" *ngIf="showtransaction">
  <div class="card">
    <div class="card-header">
      <h4><strong> Historique Transactions </strong></h4>
    </div>
    <div class="card-body" class="cadre-table-scroll">
      <br>
      <div align="left">
        <h5><b>&nbsp;&nbsp;&nbsp; Nombre total des transactions : {{nbTotalResults}} </b></h5> 
      </div>
      <div class="col-md-12 text-right" > <button (click)="getLogDetailClientTransactionsEXCEL()" class="btn btn-success"> Export excel</button> </div>
      <br>
      <table class="table table-striped table-scroll" *ngIf="resultTransactionClients && resultTransactionClients.length > 0">
        <thead>
          <tr>
            <th style="width: 50px;">Date</th>
            <th>Client</th>
            <th>Porteur</th>
            <th>Num°carte</th>
            <th>Type carte</th>
            <th>ID station</th>
            <th>Station</th>
            <th>Produit</th>
            <th>Numéro TPE</th>
            <th>Numéro ticket</th>
            <th>Montant transaction</th>
            <th>Commercant</th>
            <!-- <th>Date transaction</th> -->
            <th>Code autorisation</th>
            <th>Code retour</th>
            <th>Kilométrage</th>
            <th>Solde Carte Disponible</th>
            <th>Solde restant Prépayé</th>
            <th>Solde restant Prépayé à terme</th>
            <th>Solde restant Postpayé</th>
            <th>Solde global </th>

        </thead>
        <tbody>
          
          <tr *ngFor="let item of resultTransactionClients ">
            <td style="width: 50px;">{{item.date }}</td>
            <td>{{item.client}}</td>
            <td>{{item.nomPorteur}}</td>
            <td>{{item.numCarte}}</td>
            <td>{{item.typeCarte}}</td>
            <td>{{item.idStation }}</td>
            <td>{{item.nomStation}}</td>
            <td>{{item.produit}}</td>
            <td>{{item.idterminal}}</td>
            <td>{{item.numTicket}}</td>
            <td>{{item.montant | amountmillierpipe}}</td>
            <td>{{item.nomAdresseCommercant}}</td>
            <!-- <td>{{item.datetransaction}}</td> -->
            <td>{{item.codeAutorisation}}</td>
            <td>{{item.codeReponse == '00 '? 'Approuvée' : item.codeReponseDes }}</td>
            <td>{{item.kilometrage}}</td>
            <td>{{item.soldeCarteDispo | amountmillierpipe}}</td>
            <td>{{item.soldeRestantpp | amountmillierpipe }}</td>
            <td>{{item.soldeRestantppe | amountmillierpipe }} </td>
            <td>{{item.soldeRestantps | amountmillierpipe }} </td>
            <td>{{item.soldeGlobale | amountmillierpipe}} </td>
          </tr>
          
          
        </tbody>
      </table>
      <div *ngIf="displayNoDataMessage">
        <br><br><br>
        <div align="center"><h4> Aucune donnée disponible. </h4></div>
      </div>
    </div>
  </div>
</div>








<!-- ************************************* LOG Recharge ***************************************************** -->

<div class="animated fadeIn" *ngIf="showRecharge">
  <div class="card">
    <div class="card-header">
      <h4><strong> Historique Recharge </strong></h4>
    </div>

    <div class="card-body" class="cadre-table-scroll">
      <br>
      <div class="col-md-12 text-right" > <button (click)="getLogDetailClientRechargeEXCEL()" class="btn btn-success"> Export excel</button> </div>
      <br>
      <table class="table table-striped table-scroll" *ngIf="resultRechargeClients && resultRechargeClients.length > 0">
        <thead>
          <tr>
            <th>Date</th>
            <th>ID Client</th>
            <th>Client</th>
            <th>Num°carte Emettrice</th>
            <th>Num°carte Réceptrice</th>
            <th>Porteur</th>
            <th>Bon Recharge</th>
            <th>Montant Recharge</th>
            <th>Type carte</th>
            <th>Type transaction</th>
            <th>Type solde</th>
        </thead>
        <tbody>
         
            <tr *ngFor="let item of resultRechargeClients ">
              <td>{{item.dateTimeSystem | dateSql}}</td>
              <td>{{item.iDclient}}</td>
              <td>{{item.client}}</td>
              <td>{{item.numCarteEmetteur}}</td>
              <td>{{item.numCarteRecp}}</td>
              <td>{{item.porteur}}</td>
              <td>{{item.bonRecharge}}</td>
              <td>{{item.montantRecharge | amountmillierpipe }}</td>
              <td>{{item.typeCarte}}</td>
              <td>{{item.typeTransaction}}</td>
              <td>{{item.typesolde}}</td>
            </tr>
      
        </tbody>
      </table>
      <div *ngIf="NoDataMessage">
        <br><br><br>
        <div align="center"><h4> Aucune donnée disponible. </h4></div>
      </div>
    </div>
  </div>
</div>